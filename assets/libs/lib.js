function Modal(t="modal"){let e=document.getElementsByClassName(t),n={},i;function r(t){let e=t.hasAttribute("auto-hide"),n=t.hasAttribute("offset-close"),r=t.hasAttribute("btn-close"),o=t.querySelector(".container")||t;function l(){let t=document.createElement("div");return t.setAttribute("class","btn-close"),t.innerHTML="x",t}function u(){t.setAttribute("hide",1)}return!function e(){if(n&&(t.onclick=function(e){e.target==t&&u()}),r){let i,c;i=new l,o.appendChild(i),c=document.createElement("div"),o.appendChild(c),o=c,i.onclick=u}}(),{show:function n(r){clearTimeout(i),t.removeAttribute("hide"),r&&(o.innerHTML=r),e&&(i=setTimeout(u,t.getAttribute("auto-hide")||100*o.innerHTML.length))},hide:u}}return!function t(){for(let i=0;i<e.length;i++){let o=e[i],l=r(o),u;Object.defineProperty(n,o.id,{get:function(){return l}})}}(),n}
function FormValidate(e,n={},t={},u=!0){let r=ValidateByString(n.rules,n.messages),l={};function i(){let e=document.createElement("div");return e.classList.add("valid-msg"),e}function a(e,n={},l=u){if(n={onfocus:n.onfocus||t.onfocus,onValidSuccess:n.onValidSuccess||t.onValidSuccess,onInputPass:n.onInputPass||t.onInputPass,onInputFail:n.onInputFail||t.onInputFail},!e.elements)return;let a=!1,o=[];function s(e){let t=r.action(e[1],e[0].value);return!0!==t?n.onInputFail(e[0],t):n.onInputPass(e[0]),t}e.el_error=new i,e.onsubmit=function(t){a=!0;!0===function e(n){let t=!0;for(let u=0;u<n.length;u++)!0!==s(n[u])&&(t=!1);return t}(o)?n.onValidSuccess(e,t):t.preventDefault()},!function t(){for(let u=0;u<e.elements.length;u++){let r=e.elements[u];if(str_validates=r.getAttribute("validates")){r.el_error=new i;let c=[r,str_validates];o.push(c),r.onfocus=function(){n.onfocus(r)},l&&(r.onkeyup=r.onblur=function(){a&&s(c)})}}}()}return t={onkeyup:t.onkeyup||function(){},onfocus:t.onfocus||function(){},onValidSuccess:t.onValidSuccess||function(){},onInputPass:t.onInputPass||function(){},onInputFail:t.onInputFail||function(){}},!function n(){for(let t in e)a(e[t]);Object.defineProperties(l,{add:{get:function(){return a}}})}(),l}function _FormValidate(e=document.getElementsByTagName("form"),n,t=function(){},u=!0){return new FormValidate(e,n,{onValidSuccess:t,onInputPass(e){let n=e.parentElement;e.el_error.remove(),n&&n.setAttribute("is_valid",!0)},onInputFail(e,n){let t=e.parentElement,u=e.el_error;u.innerHTML=n,t&&t.setAttribute("is_valid",!1),t.insertBefore(u,e)},onfocus(e){let n=e.parentElement;e.el_error.remove(),n&&n.removeAttribute("is_valid")}},u)}function ValidateByString(e,n={}){let t=Object.assign({},{required:(e,t)=>""!=t||n.required||"value is empty",email:(e,t)=>/\S+@\S+\.\S+/.test(t)||n.email||"value is not an email!",between(e,t){let u=e[0],r=e[1],l=t.length;return u<=l&&l<=r||n.between||`value required form ${u} to ${r} character!`},min(e,t){let u=e[0];return u<=t.length||n.min||`value smaller ${u} character!`},max(e,t){let u=e[0];return u>=t.length||n.max||`value bigger ${u} character!`},numeric:(e,t)=>!isNaN(t)||n.numeric||"value is not a number!",num_min(e,t){let u=e[0];return u<=parseInt(t)||n.num_min||`value bigger ${u} required!`},num_max(e,t){let u=e[0];return u>=parseInt(t)||n.num_max||`value smaller ${u} required!`},num_between(e,t){let u=e[0],r=e[1];return u<=(t=parseInt(t))&&t<=r||n.num_between||`value bigger ${u} and smaller ${r} required!`},same:(e,t)=>document.getElementById(e[0]).value===t||n.same||`value not match ${e[0]}`,username:(e,n)=>!!n.match(/^[a-zA-Z0-9\-]+$/)||"T\xe0i khoản kh\xf4ng hợp lệ",password:(e,n)=>!!n.match(/^[a-zA-Z0-9\-!@#\$%\^&\*]+$/)||"Mật khẩu kh\xf4ng hợp lệ",strong(e,n){var t=0;return t+=/[!@#$%^&*?_~]{1,}/.test(n)?1:0,t+=/[a-z]{1,}/.test(n)?1:0,t+=/[A-Z]{1,}/.test(n)?1:0,(t+=/[0-9]{1,}/.test(n)?1:0)>=3||"Mật khẩu yếu"}},e);function u(e,n=null){let u=e.split("|");for(let r in u){let l=u[r].split(":")||null;if(!t[l[0]])continue;let i=l[1]?l[1].split(","):null,a=t[l[0]](i,n);if(!0!==a)return a}return!0}return Object.defineProperty({},"action",{get:function(){return u}})}
function ajax(e,t,n,o){let r=new XMLHttpRequest,s=o.beforeSend||Function(),a=o.afterSend||Function(),d=o.success||Function(),i=o.error||Function();s(),r.onload=function(){4===this.readyState&&200===this.status&&d(this.responseText),a()},r.onerror=i,r.open(t,e,!0),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.send(new URLSearchParams(n).toString())}
